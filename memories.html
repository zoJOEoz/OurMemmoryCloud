<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>Our Memory Cloud</title> 
    <style>
        body {
            background-color: #1a1a1a;
            color: #f0f0f0;
            font-family: 'Microsoft JhengHei', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        #cloud-wrapper {
            transform: scale(1);
            transform-origin: center center;
            transition: transform 0.3s ease;
        }

        .cloud-container {
            width: 80%;
            max-width: 900px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 17px;
        }

        .keyword {
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            color: #888;
        }

        .keyword:hover {
            color: #f7ff1e;
            transform: scale(1.2);
            z-index: 10;
            text-shadow: 0 0 10px #a1a1a1;
        }

        .keyword:hover::after {
            content: attr(data-story);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(255, 255, 255, 0.95);
            color: #000;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            white-space: pre-wrap;
            width: max-content;
            max-width: 250px;
            pointer-events: none;
            margin-bottom: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .lv1 { font-size: 35px; opacity: 0.8; font-weight: bold; color: #eeecec; }
        .lv2 { font-size: 42px; opacity: 0.9; font-weight: bold; color: #f3f3f3; }
        .lv3 { font-size: 58px; opacity: 1; font-weight: 900; color: #fff; }

        .pink { color: pink !important; }
        .blue { color: deepskyblue !important; }

        /* 固定滑桿在頁面最下方 */
        #zoom-control {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
        }
    </style>
</head>
<body>
    <div id="cloud-wrapper">
        <div class="cloud-container" id="cloud"></div>
    </div>

    <!-- 縮放控制滑桿 -->
    <input id="zoom-control" type="range" min="0.5" max="2" step="0.1" value="1">

    <script>
        async function loadGoogleSheet() {
            const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQI8PA8c84KosV2LG19MeIeLXXq3iJPAxKwHajDxy-rznzy2OR2CZLKPuqcLXIwfXqp_gAdJAaoHS1L/pub?gid=0&single=true&output=csv";
            const response = await fetch(url);
            const text = await response.text();

            let lines = text.trim().split('\n');

            // 打亂順序
            for (let i = lines.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [lines[i], lines[j]] = [lines[j], lines[i]];
            }

            const container = document.getElementById('cloud');

            lines.forEach(line => {
                const parts = line.split(',');
                const level = parts[0]?.trim();
                const story = parts[1]?.trim();
                const title = parts[2]?.trim();
                const flag = parts[3]?.trim();

                const span = document.createElement('span');
                span.className = `keyword ${level}`;
                span.setAttribute('data-story', story);
                span.textContent = title;

                if (flag === "L") {
                    span.classList.add("pink");
                } else if (flag === "Y") {
                    span.classList.add("blue");
                }

                container.appendChild(span);
            });
        }

        loadGoogleSheet();

        // 縮放控制
        const zoomControl = document.getElementById('zoom-control');
        const wrapper = document.getElementById('cloud-wrapper');
        zoomControl.addEventListener('input', () => {
            const scale = zoomControl.value;
            wrapper.style.transform = `scale(${scale})`;
        });
    </script>
</body>
</html>